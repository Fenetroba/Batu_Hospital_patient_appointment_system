import{b as y,r as x,j as e,t as S,V as q,u as k,K as I,J as E,e as N,O as w,Q as B,au as L,ak as G,C as H,a0 as K,a1 as D,a2 as z,a3 as J,a4 as U,a5 as Q,a6 as X,a7 as V,a8 as Y,a9 as W,X as Z,aa as $,ab as ee,ac as te,ad as se,f as ae,U as M,W as re,ae as ne,af as ie,al as oe,am as le,an as de,ao as ce,ap as me,aq as xe,ar as he,as as ue,at as ge,av as pe,aw as fe,ax as be,E as ve,ay as Ne,az as je}from"./index-Cd3MSik5.js";import{L as ye}from"./Language-BEainxfY.js";import{P as we,a as Ce,b as Se}from"./popover-DluOy0de.js";import{D as F,f as ke,a as O,b as De,c as Pe,d as Ae,g as _e,S as Me,R as Ee,L as Re,e as P}from"./LineChart-5kCbGbjO.js";import{U as Ie}from"./users-BvngG-KP.js";import{R as Le,C as Ue,X as $e,Y as Fe,T as Oe,L as Te}from"./CartesianChart-CxBfZ7I9.js";import"./select-DEhhGhDG.js";const qe=()=>{const s=y(),[t,o]=x.useState({firstName:"",lastName:"",gender:"",birthDate:new Date,bloodGroup:"",email:"",phoneNumber:"",address:"",emergencyContactName:"",emergencyContactPhone:"",insuranceNumber:""}),[p,h]=x.useState(!1),l=a=>{const{name:u,value:i}=a.target;o(d=>({...d,[u]:i}))},c=async a=>{if(a.preventDefault(),!t.firstName||!t.lastName||!t.email||!t.gender||!t.birthDate||!t.phoneNumber||!t.address){S.error("Please fill in all required fields");return}try{h(!0);const u={fullName:`${t.firstName} ${t.lastName}`.trim(),email:t.email,password:"Ba@1234",role:"Patient",address:t.address,phone:t.phoneNumber,gender:t.gender,birthDate:t.birthDate,bloodGroup:t.bloodGroup,emergencyContactName:t.emergencyContactName,emergencyContactPhone:t.emergencyContactPhone},i=await s(q(u));if(i.meta.requestStatus==="fulfilled")S.success(i.payload?.message||"Patient registered");else{const d=i.payload?.message||i.error?.message||"Registration failed";S.error(d);return}o({firstName:"",lastName:"",gender:"",birthDate:"",bloodGroup:"",email:"",phoneNumber:"",address:"",emergencyContactName:"",emergencyContactPhone:""})}catch{S.error("Registration failed")}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-2",children:e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 bg-[var(--six)] rounded-xl p-4",children:e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Register Patient"})}),e.jsxs("form",{onSubmit:c,className:"bg-[var(--six)] rounded-xl p-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"firstName",value:t.firstName,onChange:l,placeholder:"First Name",required:!0}),e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"lastName",value:t.lastName,onChange:l,placeholder:"Last Name",required:!0}),e.jsxs("select",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"gender",value:t.gender,onChange:l,required:!0,children:[e.jsx("option",{value:"",className:"text-black",children:"Gender"}),e.jsx("option",{value:"Male",className:"text-black",children:"Male"}),e.jsx("option",{value:"Female",className:"text-black",children:"Female"})]}),e.jsx("input",{type:"date",className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"birthDate",value:t.birthDate,onChange:l,placeholder:"Age",required:!0}),e.jsxs("select",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"bloodGroup",value:t.bloodGroup,onChange:l,children:[e.jsx("option",{value:"",className:"text-black",children:"Blood Group"}),e.jsx("option",{value:"A+",className:"text-black",children:"A+"}),e.jsx("option",{value:"A-",className:"text-black",children:"A-"}),e.jsx("option",{value:"B+",className:"text-black",children:"B+"}),e.jsx("option",{value:"B-",className:"text-black",children:"B-"}),e.jsx("option",{value:"AB+",className:"text-black",children:"AB+"}),e.jsx("option",{value:"AB-",className:"text-black",children:"AB-"}),e.jsx("option",{value:"O+",className:"text-black",children:"O+"}),e.jsx("option",{value:"O-",className:"text-black",children:"O-"})]}),e.jsx("input",{type:"email",className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"email",value:t.email,onChange:l,placeholder:"Email"}),e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"phoneNumber",value:t.phoneNumber,onChange:l,placeholder:"Phone Number",required:!0}),e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)] md:col-span-2",name:"address",value:t.address,onChange:l,placeholder:"Address",required:!0}),e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"emergencyContactName",value:t.emergencyContactName,onChange:l,placeholder:"Emergency Contact Name"}),e.jsx("input",{className:"border text-white bg-transparent border-gray-300 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",name:"emergencyContactPhone",value:t.emergencyContactPhone,onChange:l,placeholder:"Emergency Contact Phone"}),e.jsx("div",{className:"md:col-span-2 flex justify-end",children:e.jsx("button",{type:"submit",disabled:p,className:"bg-[var(--one)] text-black font-bold px-6 py-3 rounded-md hover:bg-opacity-90 transition-colors disabled:opacity-50",children:p?"Register...":"Register"})})]})]})})},T=({active:s,onEdit:t,onToggleStatus:o,onDelete:p})=>{const{t:h}=k(),[l,c]=x.useState(!1);return e.jsxs(we,{children:[e.jsx(Ce,{asChild:!0,children:e.jsx("button",{"aria-label":h("actions")||"Actions",className:"h-8 w-8 flex items-center justify-center rounded-md border border-[var(--one)] text-[var(--one)] hover:bg-[var(--one)] hover:text-black transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-4 w-4",children:e.jsx("path",{fillRule:"evenodd",d:"M12 4.5a.75.75 0 01.75.75v6h6a.75.75 0 010 1.5h-6v6a.75.75 0 01-1.5 0v-6h-6a.75.75 0 010-1.5h6v-6A.75.75 0 0112 4.5z",clipRule:"evenodd"})})})}),e.jsx(Se,{className:"w-48 p-2 bg-[var(--six)] border-[var(--two)]",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:t,className:"w-full text-left px-3 py-2 rounded-md text-white hover:bg-[var(--four)]",children:h("edit")||"Edit"}),e.jsx("button",{onClick:o,className:"w-full text-left px-3 py-2 rounded-md text-white hover:bg-[var(--four)]",children:s?h("deactivate")||"Deactivate":h("activate")||"Activate"}),e.jsxs(F,{open:l,onOpenChange:c,children:[e.jsx(ke,{asChild:!0,children:e.jsx("button",{onClick:()=>c(!0),className:"w-full text-left px-3 py-2 rounded-md text-red-400 hover:bg-red-500/10",children:h("delete")||"Delete"})}),e.jsxs(O,{children:[e.jsxs(De,{children:[e.jsx(Pe,{children:h("confirmDelete")||"Delete this patient?"}),e.jsx(Ae,{children:h("thisActionCannotBeUndone")||"This action cannot be undone."})]}),e.jsxs(_e,{children:[e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 rounded-md border border-gray-500 text-black",children:h("cancel")||"Cancel"}),e.jsx("button",{onClick:()=>{c(!1),p?.()},className:"px-4 py-2 rounded-md bg-red-600 text-white",children:h("confirm")||"Confirm"})]})]})]})]})})]})},Be=({checked:s,onChange:t})=>e.jsx(Me,{checked:s,onCheckedChange:t,"aria-label":"Toggle status"}),Ge=({patient:s,onClose:t,onSubmit:o})=>{const{t:p}=k(),h=y(),[l,c]=x.useState({firstName:s?.firstName||"",lastName:s?.lastName||"",phone:s?.phone||"",gender:s?.gender||"",email:s?.email||"",emergencyContact:s?.emergencyContact||""}),a=i=>{c({...l,[i.target.name]:i.target.value})},u=async i=>{i.preventDefault();try{await h(I({id:s.id,userData:{firstName:l.firstName,lastName:l.lastName,phone:l.phone,gender:l.gender,email:l.email,emergencyContact:l.emergencyContact}})).unwrap(),E.success(p("patientUpdated")||"Patient updated successfully"),o?.(),t?.()}catch(d){E.error(d.message||"Failed to update patient")}};return e.jsxs("div",{className:"p-6 bg-[var(--six)] rounded-xl",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Edit Patient"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",value:l.firstName,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",value:l.lastName,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Gender"}),e.jsxs("select",{name:"gender",value:l.gender,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",required:!0,children:[e.jsx("option",{value:"",children:"Select Gender"}),e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Emergency Contact"}),e.jsx("input",{type:"tel",name:"emergencyContact",value:l.emergencyContact,onChange:a,className:"w-full border border-gray-300 bg-transparent text-white rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-500 text-white rounded-md hover:bg-gray-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-[var(--one)] text-black rounded-md hover:bg-[var(--one)]/90",children:"Update"})]})]})]})},He=()=>{const{t:s}=k(),[t,o]=x.useState(""),[p,h]=x.useState(!1),[l,c]=x.useState(null),a=y(),{users:u,loading:i}=N(m=>m.user);x.useEffect(()=>{a(w())},[a]);const d=x.useMemo(()=>(u||[]).filter(g=>g.role==="Patient").map(g=>({id:g._id||g.id,fullName:g.fullName||`${g.firstName||""} ${g.lastName||""}`.trim(),firstName:g.firstName,lastName:g.lastName,phone:g.phone||g.phoneNumber,gender:g.gender,email:g.email,emergencyContact:g.emergencyContact,active:typeof g.isActive=="boolean"?g.isActive:g.active??!0})),[u]),n=x.useMemo(()=>{const m=t.toLowerCase().trim();return m?d.filter(g=>(g.fullName||"").toLowerCase().includes(m)||(g.phone||"").toLowerCase().includes(m)||(g.id||"").toString().toLowerCase().includes(m)):d},[t,d]),b=async m=>{await a(B(m))},r=m=>{c(m),h(!0)},f=()=>{h(!1),c(null)},v=()=>{a(w())},j=async m=>{try{const g=u.find(C=>(C._id||C.id)===m);if(g){const C=!(g.isActive??g.active);console.log(C),await a(I({id:m,userData:{isActive:C}})),a(w())}}catch(g){console.error("Error toggling patient status:",g)}};return e.jsxs("div",{className:"bg-[var(--three)] rounded-xl p-5 overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:s("patients")||"Patients"}),e.jsx(ye,{})]}),e.jsxs("div",{className:"flex w-[90vw] gap-2 mb-4",children:[e.jsx("input",{value:t,onChange:m=>o(m.target.value),placeholder:s("searchPatients")||"Search by name, phone or ID",className:"flex-1 border  bg-transparent border-gray-300  rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-[var(--one)]"}),e.jsx("button",{className:"bg-[var(--one)] text-black font-semibold px-4 py-2 rounded-md",onClick:()=>o(""),children:s("clear")||"Clear"})]}),e.jsx("div",{className:" ",children:e.jsxs("table",{className:" text-left overflow-y-auto w-[90vw]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-300 ",children:[e.jsx("th",{className:"py-2 pr-4",children:s("patientId")||"Patient ID"}),e.jsx("th",{className:"py-2 pr-4",children:s("name")||"Name"}),e.jsx("th",{className:"py-2 pr-4",children:s("phoneNumber")||"Phone Number"}),e.jsx("th",{className:"py-2 pr-4",children:s("gender")||"Gender"}),e.jsx("th",{className:"py-2 pr-4",children:s("email")||"Email"}),e.jsx("th",{className:"py-2 pr-4",children:s("emergencyContact")||"Emergency Contact"}),e.jsx("th",{className:"py-2 pr-4",children:s("status")||"Status"}),e.jsx("th",{className:"py-2 pr-4",children:s("actions")||"Actions"}),e.jsx("th",{className:"py-2 pr-4",children:"Reset Password"})]})}),e.jsx("tbody",{children:n.map(m=>e.jsxs("tr",{className:"border-t border-[var(--two)] text-gray-300 hover:bg-[var(--three)]",children:[e.jsxs("td",{className:"py-2 pr-4",children:["P_",m.id]}),e.jsx("td",{className:"py-2 pr-4",children:m.fullName||`${m.firstName||""} ${m.lastName||""}`}),e.jsx("td",{className:"py-2 pr-4",children:m.phone||""}),e.jsx("td",{className:"py-2 pr-4",children:m.gender}),e.jsx("td",{className:"py-2 pr-4",children:m.email}),e.jsx("td",{className:"py-2 pr-4",children:m.emergencyContact}),e.jsx("td",{className:"py-2 pr-4 ",children:e.jsx(Be,{checked:m.active,onChange:()=>j(m.id)})}),e.jsx("td",{className:"py-2 pr-4",children:e.jsx(T,{active:m.active,onEdit:()=>r(m),onToggleStatus:()=>j(m.id),onDelete:()=>b(m.id)})}),e.jsxs("td",{children:[console.log(m.id),e.jsx(Ee,{userId:m.id})]})]},m.id))})]})}),e.jsx("div",{className:"text-gray-300 text-sm mt-3",children:`Showing ${n.length} records`}),p&&e.jsx(F,{open:p,onOpenChange:h,children:e.jsx(O,{className:"max-w-2xl",children:e.jsx(Ge,{patient:l,onClose:f,onSubmit:v})})})]})},Ke=()=>{const{t:s}=k(),[t,o]=x.useState("create");return e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-2",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"bg-[var(--six)] rounded-xl p-2 mb-4 flex gap-2",children:[e.jsx("button",{onClick:()=>o("create"),className:`px-4 py-2 rounded-md ${t==="create"?"bg-[var(--one)] text-black":"text-white"}`,children:s("Create")||"Create"}),e.jsx("button",{onClick:()=>o("fetch"),className:`px-4 py-2 rounded-md ${t==="fetch"?"bg-[var(--one)] text-black":"text-white"}`,children:s("Fetch")||"Fetch"})]}),e.jsxs("div",{children:[t==="create"&&e.jsx(qe,{}),t==="fetch"&&e.jsx(He,{}),t==="deletes"&&e.jsx(T,{})]})]})})},ze=()=>{const s=y(),{users:t,loading:o}=N(c=>c.user);x.useEffect(()=>{s(w())},[s]);const p=x.useMemo(()=>(t||[]).filter(c=>c.role==="Patient"||!c.role),[t]),h=x.useMemo(()=>{const c=p.length,a=p.filter(d=>typeof d.isActive=="boolean"?d.isActive:!0).length,u=new Date().toISOString().slice(0,10),i=p.filter(d=>{const n=d.createdAt||d.created_at||d.registrationDate;return n?new Date(n).toISOString().slice(0,10)===u:!1}).length;return{totalPatients:c,activePatients:a,todayRegistrations:i}},[p]),l=x.useMemo(()=>{const c=a=>a.fullName||`${a.firstName||""} ${a.lastName||""}`.trim()||"Unknown";return[...p].map(a=>({id:a._id||a.id,name:c(a),date:(()=>{const u=a.createdAt||a.created_at||a.registrationDate;return u?new Date(u).toISOString().slice(0,10):""})()})).sort((a,u)=>(u.date||"").localeCompare(a.date||"")).slice(0,5)},[p]);return e.jsxs("div",{className:"p-6 bg-[var(--six)] rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white mb-5",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Reports"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"border border-[var(--four)] rounded-lg p-4 text-white flex items-center gap-3",children:[e.jsx(Ie,{className:"h-6 w-6 text-[var(--one)]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Total Patients"}),e.jsx("div",{className:"text-2xl font-semibold",children:h.totalPatients})]})]}),e.jsxs("div",{className:"border border-[var(--four)] rounded-lg p-4 text-white flex items-center gap-3",children:[e.jsx(G,{className:"h-6 w-6 text-[var(--one)]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Active Patients"}),e.jsx("div",{className:"text-2xl font-semibold",children:h.activePatients})]})]}),e.jsxs("div",{className:"border border-[var(--four)] rounded-lg p-4 text-white flex items-center gap-3",children:[e.jsx(H,{className:"h-6 w-6 text-[var(--one)]"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-300",children:"Today Registrations"}),e.jsx("div",{className:"text-2xl font-semibold",children:h.todayRegistrations})]})]})]}),e.jsxs("div",{className:"border border-[var(--four)] rounded-lg p-4",children:[e.jsx("div",{className:"text-white font-medium mb-3",children:"Recent Registrations"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-300",children:[e.jsx("th",{className:"py-2 pr-4",children:"Patient ID"}),e.jsx("th",{className:"py-2 pr-4",children:"Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Date"})]})}),e.jsx("tbody",{children:l.map(c=>e.jsxs("tr",{className:"border-t border-[var(--four)] text-white",children:[e.jsxs("td",{className:"py-2 pr-4",children:["P_",c.id]}),e.jsx("td",{className:"py-2 pr-4",children:c.name}),e.jsx("td",{className:"py-2 pr-4",children:c.date})]},c.id))})]})})]})]})};let A;const Je=s=>(A||(A=$("http://localhost:5000",{auth:{token:s},withCredentials:!0})),A),Qe=({user:s})=>{const t=y(),{currentUser:o}=N(n=>n.auth),{messages:p,loading:h}=N(n=>n.messages),[l,c]=x.useState(""),[a,u]=x.useState(null),i=x.useRef(null);x.useEffect(()=>{if(!o)return;const n=localStorage.getItem("token"),b=Je(n);return b.on("new_message",r=>{const f=r.sender?._id||r.sender,v=r.receiver?._id||r.receiver;(f===s._id&&v===o.id||f===o.id&&v===s._id)&&(t(K(r)),f===s._id&&t(D({from:s._id})))}),b.on("message_updated",r=>{t(z(r))}),b.on("messages_read",r=>{(r.fromUser===o.id||r.conversationId)&&t(D({from:o.id,isReadReceipt:!0}))}),()=>{b.off("new_message"),b.off("message_updated"),b.off("messages_read")}},[s,o,t]),x.useEffect(()=>{s&&s._id&&o?.id&&(t(J({userA:o.id,userB:s._id})),t(D({from:s._id})),t(U(s._id)),u(null),c(""))},[s,o,t]),x.useEffect(()=>{c(a?a.content:"")},[a]),x.useEffect(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[p]);const d=()=>{const n=l.trim();if(n){if(a)ee(t,a._id,n,u);else{if(!s?._id)return;t(te({receiver:s._id,content:n}))}c("")}};return e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[h&&e.jsx("div",{className:"text-gray-300",children:"Loading..."}),p.map(n=>e.jsxs("div",{className:`max-w-[75%] px-3 py-2 rounded-md group relative ${n.sender?._id===o.id?"bg-blue-600 text-white ml-auto":"bg-gray-700 text-white"}`,children:[e.jsx("div",{className:"text-sm break-words",children:n.content||n.text}),e.jsxs("div",{className:`text-[10px] mt-1 flex items-center justify-end gap-1 ${n.sender?._id===o.id?"text-blue-200":"text-gray-400"}`,children:[e.jsx("span",{children:new Date(n.createdAt||n.sentAt||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),n.sender?._id===o.id&&(n.status==="read"?e.jsx(Q,{size:12,className:"text-white"}):e.jsx(X,{size:12,className:"text-white"}))]}),n.sender?._id===o.id&&e.jsx("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(V,{onEdit:()=>W(u,n),onDelete:()=>Y(t,n._id)})})]},n._id||n.id)),e.jsx("div",{ref:i})]}),e.jsxs("div",{className:"p-3 border-t border-[var(--four)] flex gap-2 items-center",children:[a&&e.jsx("button",{onClick:()=>u(null),className:"text-red-500 hover:bg-red-100 p-2 rounded-full",children:e.jsx(Z,{size:20})}),e.jsx("input",{value:l,onChange:n=>c(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),d())},placeholder:a?"Edit message...":s?"Type a message...":"Select a user to start chatting",className:"flex-1 bg-transparent border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-[var(--one)]"}),e.jsx("button",{onClick:d,disabled:!s&&!a||!l.trim(),className:"px-4 py-2 rounded-md bg-[var(--one)] text-black disabled:opacity-50",children:a?"Update":"Send"})]})]})};let _;const Xe=s=>(_||(_=$("http://localhost:5000",{auth:{token:s},withCredentials:!0})),_),Ve=()=>{const s=y(),{users:t,loading:o}=N(r=>r.user),{currentUser:p}=N(r=>r.auth),{unreadCounts:h}=N(r=>r.messages),[l,c]=x.useState(""),[a,u]=x.useState(null);x.useEffect(()=>{s(w())},[s]),x.useEffect(()=>{if(!p)return;const r=localStorage.getItem("token"),f=Xe(r);return f.on("new_message",v=>{const j=v.sender?._id||v.sender;(v.receiver?._id||v.receiver)===p.id&&j!==a&&s(se(j))}),()=>{f.off("new_message")}},[p,a,s]);const i=x.useMemo(()=>(t||[]).filter(r=>r.role==="Patient"||r.role==="Admin"),[t]),d=x.useMemo(()=>{const r=l.trim().toLowerCase();return r?i.filter(f=>(f.fullName||`${f.firstName||""} ${f.lastName||""}`).toLowerCase().includes(r)||(f.phone||f.phoneNumber||"").toLowerCase().includes(r)):i},[i,l]),n=x.useMemo(()=>d.find(r=>(r._id||r.id)===a)||i.find(r=>(r._id||r.id)===a),[d,i,a]);x.useEffect(()=>{!a&&d.length>0&&u(d[0]._id||d[0].id)},[d,a]);const b=r=>{u(r),s(U(r))};return e.jsxs("div",{className:"p-4 md:p-6 bg-[var(--six)] rounded-xl min-h-[70vh] grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-1 border border-[var(--two)] rounded-lg overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-[var(--two)] text-white flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Inbox"})]}),e.jsx("div",{className:"p-3",children:e.jsx("input",{value:l,onChange:r=>c(r.target.value),placeholder:"Search patients...",className:"w-full bg-transparent border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-[var(--one)]"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-[var(--two)]",children:[o&&e.jsx("div",{className:"p-3 text-gray-300",children:"Loading..."}),!o&&d.map(r=>{const f=r._id||r.id,v=r.fullName||`${r.firstName||""} ${r.lastName||""}`,j=h[f]||0;return e.jsx("button",{onClick:()=>b(f),className:`w-full text-left p-3 hover:bg-[var(--five)] ${a===f?"bg-[var(--four)]":""}`,children:e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-[var(--one)] flex items-center justify-center text-black",children:e.jsx(M,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:v}),e.jsx("div",{className:"text-xs text-gray-300 truncate",children:r.phone||r.phoneNumber||"No phone"})]}),j>0&&e.jsx("div",{className:"bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:j>9?"9+":j})]})},f)}),!o&&d.length===0&&e.jsx("div",{className:"p-3 text-gray-300",children:"No Patients Found"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 border border-[var(--four)] rounded-lg flex flex-col overflow-hidden bg-[var(--six)]",children:[e.jsxs("div",{className:"p-3 border-b border-[var(--four)] text-white flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:n?n.fullName||`${n.firstName||""} ${n.lastName||""}`:"Select a User"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Qe,{user:n})})]})]})},R=()=>{const s=y(),{currentUser:t}=N(i=>i.auth),{users:o}=N(i=>i.user),{appointments:p}=N(i=>i.appointments),{notifications:h=[],loading:l}=N(i=>i.notifications);x.useEffect(()=>{s(w()),s(re()),s(ne())},[s]);const c=x.useMemo(()=>o.filter(i=>i.isActive&&i.role==="Patient").length,[o]),a=x.useMemo(()=>{const i=new Date().toISOString().split("T")[0];return p.filter(d=>d.date?new Date(d.date).toISOString().split("T")[0]===i:!1).length},[p]),u=x.useMemo(()=>{const d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(n=>({name:n,total:0,male:0,female:0}));return o.filter(n=>n.role==="Patient"&&n.createdAt).forEach(n=>{const r=new Date(n.createdAt).getMonth();r>=0&&r<12&&(d[r].total+=1,n.gender==="Male"?d[r].male+=1:n.gender==="Female"&&(d[r].female+=1))}),d},[o]);return e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 bg-[var(--six)] rounded-xl p-4",children:[e.jsxs("h1",{className:"text-white border-1 px-3 py-1 rounded-xl",children:[t?.gender==="Male"?"Mr":t?.gender==="Female"?"Ms":"Mr/Ms"," ",t?.fullName]}),e.jsx("h1",{className:"text-white",children:t?.role})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-[var(--six)] rounded-xl p-5",children:[e.jsx("div",{className:"text-sm text-gray-300",children:e.jsx("h1",{children:"Active Patients"})}),e.jsx("div",{className:"text-3xl font-bold text-white mt-2",children:c})]}),e.jsxs("div",{className:"bg-[var(--six)] rounded-xl p-5",children:[e.jsx("div",{className:"text-sm text-gray-300",children:e.jsx("h1",{children:"Today's Patients"})}),e.jsx("div",{className:"text-3xl font-bold text-white mt-2",children:a})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:[e.jsx(ie,{className:"inline-block mr-2"}),"Announcements"]}),l&&e.jsx("p",{className:"text-gray-500",children:"Loading notifications..."}),!l&&h.length===0&&e.jsx("p",{className:"text-gray-500",children:"No announcements at the moment."}),e.jsx("div",{className:"space-y-4",children:h.map(i=>e.jsxs("div",{className:`border rounded-lg p-4 ${i.type==="alert"?"bg-red-100/10 border-red-200":i.type==="announcement"?"bg-blue-100/10 border-blue-200":"bg-green-100/10 border-green-200"}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:i.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(i.createdAt).toLocaleDateString()})]},i._id))})]}),e.jsxs("div",{className:"bg-[var(--six)] rounded-xl p-5",children:[e.jsx("h2",{className:"text-white mb-4",children:"Patient Registrations per Month"}),e.jsx(Le,{width:"100%",height:300,children:e.jsxs(Re,{data:u,children:[e.jsx(Ue,{strokeDasharray:"3 2"}),e.jsx($e,{dataKey:"name"}),e.jsx(Fe,{}),e.jsx(Oe,{}),e.jsx(Te,{}),e.jsx(P,{type:"monotone",dataKey:"total",stroke:"#ff7300",name:"Total"}),e.jsx(P,{type:"monotone",dataKey:"male",stroke:"#0088fe",name:"Male"}),e.jsx(P,{type:"monotone",dataKey:"female",stroke:"#ff4081",name:"Female"})]})})]})]})})},Ye=[{title:"Home",icon:ue},{title:"Inbox",icon:ge},{title:"Patients",icon:M},{title:"Reports",icon:L},{title:"Settings",icon:pe}],We=()=>{const[s,t]=x.useState("");return e.jsxs(oe,{children:[e.jsxs(le,{children:[e.jsx(de,{className:"bg-[var(--six)]",children:e.jsxs(ce,{children:[e.jsx(me,{className:" text-[var(--two)] text-[18px] mb-10 font-bold",children:"RESEPTION DASHBOARD"}),e.jsx(xe,{children:e.jsx(he,{children:Ye.map(o=>e.jsx(fe,{children:e.jsx(be,{asChild:!0,className:"hover:bg-[var(--three)] hover:text-[var(--six)]",children:e.jsxs("button",{onClick:()=>t(o.title),children:[e.jsx(o.icon,{className:"text-[var(--two)]"}),e.jsx("span",{className:"text-[var(--two)]  ",children:o.title})]})})},o.title))})})]})}),e.jsx(ve,{})]}),e.jsxs("main",{className:"flex-1 p-4 overflow-x-hidden",children:[e.jsx(Ne,{}),s==="Home"?e.jsx(R,{}):s==="Inbox"?e.jsx(Ve,{}):s==="Patients"?e.jsx(Ke,{}):s==="Reports"?e.jsx(ze,{}):s==="Settings"?e.jsx(je,{}):e.jsx(R,{})]})]})},it=()=>e.jsx("div",{children:e.jsx(We,{})});export{it as default};
