import{c as k,b as N,e as g,r as d,W as C,j as e,b7 as D,C as w,a as M,U as y,b8 as E,b9 as I,B as L,au as U,ae as A,af as $,a0 as S,a1 as P,a2 as v,a3 as R,a4 as B,a6 as F,a7 as T,a8 as H,a9 as q,aa as z,X as O,ab as G,ac as V,O as K,ad as Y,f as Q,a5 as W,al as X,am as J,an as Z,ao as ee,ap as se,aq as te,ar as ae,as as re,at as ne,av as ie,aw as le,ax as de,E as ce,ay as oe,az as xe}from"./index-CiVVu7O9.js";import{B as me}from"./building-2-DKBperLU.js";import{D as he,e as fe,a as ue,b as ge,c as pe,d as je}from"./dialog-CcGNoNz8.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ne=k("external-link",be),ve=()=>{const r=N(),{appointments:i,loading:n,error:c}=g(a=>a.appointments),{currentUser:f}=g(a=>a.auth);d.useEffect(()=>{r(C())},[r]);const m=d.useMemo(()=>!f||!i||!Array.isArray(i)?[]:i.filter(a=>a.patient&&typeof a.patient=="object"?a.patient._id===f.id:a.patient===f.id).sort((a,h)=>new Date(a.date)-new Date(h.date)),[i,f]),o=a=>new Date(a).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),l=a=>{switch(a?.toLowerCase()){case"scheduled":case"pending":return"bg-blue-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}};return n?e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-4 md:p-6 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(D,{className:"w-8 h-8 animate-spin text-blue-500"}),e.jsx("p",{className:"text-gray-600",children:"Loading appointments..."})]})}):c?e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-4 md:p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Appointments"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:c})]})}):e.jsx("div",{className:"min-h-screen w-full bg-[var(--one)] p-4 md:p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"My Appointments"}),m.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx(w,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Appointments Yet"}),e.jsx("p",{className:"text-gray-500",children:"You don't have any scheduled appointments at this time."})]}):e.jsx("div",{className:"space-y-4",children:m.map(a=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-blue-500"}),e.jsx("span",{className:"font-semibold text-gray-800",children:o(a.date)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:a.timeSlot||"Not specified"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:["Dr. ",a.doctor?.fullName||"Not assigned",a.doctor?.speciality&&e.jsxs("span",{className:"text-gray-500 text-sm ml-2",children:["(",a.doctor.speciality,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:a.department||"General"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`${l(a.status)} text-white px-4 py-2 rounded-full text-sm font-medium capitalize`,children:a.status||"Pending"})})]}),a.reason&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Reason: "}),a.reason]})})]},a._id))}),m.length>0&&e.jsx("div",{className:"mt-6 bg-blue-50 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["Total appointments: ",e.jsx("span",{className:"font-semibold",children:m.length})]})})]})})},ye=()=>{const r=N(),i=g(E),{appointments:n,loading:c}=g(o=>o.appointments),[f,m]=d.useState([]);return d.useEffect(()=>{i?._id&&r(I(i._id))},[i,r]),d.useEffect(()=>{if(n){const o=n.filter(l=>l.patientInfoFile).map(l=>({id:l._id,date:l.date,doctor:l.doctor,fileUrl:l.patientInfoFile,department:l.department}));m(o)}},[n]),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Medical Reports"}),e.jsxs(he,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(L,{className:"float-right p-2 m-3",children:"My Medical Information"})}),e.jsxs(ue,{className:"sm:max-w-[600px]",children:[e.jsxs(ge,{children:[e.jsx(pe,{children:"My Medical Information"}),e.jsx(je,{children:"Files uploaded by your doctors."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:c?e.jsx("p",{children:"Loading..."}):f.length>0?e.jsx("div",{className:"space-y-4",children:f.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(U,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:new Date(o.date).toLocaleDateString()}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Dr. ",o.doctor?.fullName||o.doctor?.name||"Unknown"," - ",o.department]})]})]}),e.jsxs("a",{href:o.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-blue-600 hover:text-blue-800",children:[e.jsx("span",{className:"mr-2",children:"View"}),e.jsx(Ne,{className:"h-4 w-4"})]})]},o.id))}):e.jsx("p",{className:"text-center text-gray-500",children:"No medical information files found."})})]})]})]})})},_=()=>{const r=N(),{notifications:i=[],loading:n}=g(c=>c.notifications);return d.useEffect(()=>{r(A())},[r]),e.jsxs("div",{className:"min-h-screen w-full bg-[var(--one)] p-4 md:p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Patient Dashboard"}),e.jsx("div",{children:e.jsx(ye,{})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:[e.jsx($,{className:"inline-block mr-2"}),"Announcements"]}),n&&e.jsx("p",{className:"text-gray-500",children:"Loading notifications..."}),!n&&i.length===0&&e.jsx("p",{className:"text-gray-500",children:"No announcements at the moment."}),e.jsx("div",{className:"space-y-4",children:i.map(c=>e.jsxs("div",{className:`border rounded-lg p-4 ${c.type==="alert"?"bg-red-100/10 border-red-200":c.type==="announcement"?"bg-blue-100/10 border-blue-200":"bg-green-100/10 border-green-200"}`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:c.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:c.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(c.createdAt).toLocaleDateString()})]},c._id))})]}),e.jsx(ve,{})]})},we=({user:r})=>{const i=N(),{currentUser:n}=g(t=>t.auth),{messages:c,loading:f}=g(t=>t.messages),[m,o]=d.useState(""),[l,a]=d.useState(null),h=d.useRef(null);d.useEffect(()=>{if(!n)return;const t=localStorage.getItem("token"),j=S(t);return j.on("new_message",s=>{const x=s.sender?._id||s.sender,p=s.receiver?._id||s.receiver;(x===r._id&&p===n.id||x===n.id&&p===r._id)&&(i(P(s)),x===r._id&&i(v({from:r._id})))}),j.on("message_updated",s=>{i(R(s))}),j.on("messages_read",s=>{(s.fromUser===n.id||s.conversationId)&&i(v({from:n.id,isReadReceipt:!0}))}),()=>{j.off("new_message"),j.off("message_updated"),j.off("messages_read")}},[r,n,i]),d.useEffect(()=>{r&&r._id&&n?.id&&(i(B({userA:n.id,userB:r._id})),i(v({from:r._id})),a(null),o(""))},[r,n,i]),d.useEffect(()=>{o(l?l.content:"")},[l]),d.useEffect(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[c]);const u=()=>{const t=m.trim();if(t){if(l)G(i,l._id,t,a);else{if(!r?._id)return;i(V({receiver:r._id,content:t}))}o("")}};return e.jsxs("div",{className:"flex flex-col h-[70vh]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[f&&e.jsx("div",{className:"text-gray-300",children:"Loading..."}),c.map(t=>e.jsxs("div",{className:`max-w-[75%] px-3 py-2 rounded-md group relative ${t.sender?._id===n.id?"bg-blue-600 text-white ml-auto":"bg-gray-700 text-white"}`,children:[e.jsx("div",{className:"text-sm break-words",children:t.content||t.text}),e.jsxs("div",{className:`text-[10px] mt-1 flex items-center justify-end gap-1 ${t.sender?._id===n.id?"text-blue-200":"text-gray-400"}`,children:[e.jsx("span",{children:new Date(t.createdAt||t.sentAt||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),t.sender?._id===n.id&&(t.status==="read"?e.jsx(F,{size:12,className:"text-white"}):e.jsx(T,{size:12,className:"text-white"}))]}),t.sender?._id===n.id&&e.jsx("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(H,{onEdit:()=>z(a,t),onDelete:()=>q(i,t._id)})})]},t._id||t.id)),e.jsx("div",{ref:h})]}),e.jsxs("div",{className:"p-3 border-t border-[var(--four)] flex gap-2 items-center",children:[l&&e.jsx("button",{onClick:()=>a(null),className:"text-red-500 hover:bg-red-100 p-2 rounded-full",children:e.jsx(O,{size:20})}),e.jsx("input",{value:m,onChange:t=>o(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),u())},placeholder:l?"Edit message...":r?"Type a message...":"Select a user to start chatting",className:"flex-1 bg-transparent border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-[var(--one)]"}),e.jsx("button",{onClick:u,disabled:!r&&!l||!m.trim(),className:"px-4 py-2 rounded-md bg-[var(--one)] text-black disabled:opacity-50",children:l?"Update":"Send"})]})]})},_e=()=>{const r=N(),{users:i,loading:n}=g(s=>s.user),{currentUser:c}=g(s=>s.auth),{unreadCounts:f}=g(s=>s.messages),[m,o]=d.useState(""),[l,a]=d.useState(null);d.useEffect(()=>{r(K())},[r]),d.useEffect(()=>{if(!c)return;const s=localStorage.getItem("token"),x=S(s);return x.on("new_message",p=>{const b=p.sender?._id||p.sender;(p.receiver?._id||p.receiver)===c.id&&b!==l&&r(Y(b))}),()=>{x.off("new_message")}},[c,l,r]);const h=d.useMemo(()=>(i||[]).filter(s=>s.role==="Receptionist"),[i]),u=d.useMemo(()=>{const s=m.trim().toLowerCase();return s?h.filter(x=>(x.fullName||`${x.firstName||""} ${x.lastName||""}`).toLowerCase().includes(s)||(x.phone||x.phoneNumber||"").toLowerCase().includes(s)):h},[h,m]),t=d.useMemo(()=>u.find(s=>(s._id||s.id)===l)||h.find(s=>(s._id||s.id)===l),[u,h,l]);d.useEffect(()=>{!l&&u.length>0&&a(u[0]._id||u[0].id)},[u,l]);const j=s=>{a(s),r(W(s))};return e.jsxs("div",{className:"p-4 md:p-6 bg-[var(--six)] rounded-xl min-h-[70vh] grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-1 border border-[var(--two)] rounded-lg overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-[var(--two)] text-white flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:"Inbox"})]}),e.jsx("div",{className:"p-3",children:e.jsx("input",{value:m,onChange:s=>o(s.target.value),placeholder:"Search patients...",className:"w-full bg-transparent border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-[var(--one)]"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-[var(--two)]",children:[n&&e.jsx("div",{className:"p-3 text-gray-300",children:"Loading..."}),!n&&u.map(s=>{const x=s._id||s.id,p=s.fullName||`${s.firstName||""} ${s.lastName||""}`,b=f[x]||0;return e.jsx("button",{onClick:()=>j(x),className:`w-full text-left p-3 hover:bg-[var(--five)] ${l===x?"bg-[var(--four)]":""}`,children:e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-[var(--one)] flex items-center justify-center text-black",children:e.jsx(y,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:p}),e.jsx("div",{className:"text-xs text-gray-300 truncate",children:s.phone||s.phoneNumber||"No phone"})]}),b>0&&e.jsx("div",{className:"bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:b>9?"9+":b})]})},x)}),!n&&u.length===0&&e.jsx("div",{className:"p-3 text-gray-300",children:"No Patients Found"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 border border-[var(--four)] rounded-lg flex flex-col overflow-hidden bg-[var(--six)]",children:[e.jsxs("div",{className:"p-3 border-b border-[var(--four)] text-white flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold",children:t?t.fullName||`${t.firstName||""} ${t.lastName||""}`:"Select a User"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(we,{user:t})})]})]})},Se=[{title:"Home",icon:re},{title:"Inbox",icon:ne},{title:"Settings",icon:ie}],ke=()=>{const[r,i]=d.useState("");return e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{className:"bg-[var(--six)]",children:e.jsxs(ee,{children:[e.jsx(se,{className:" text-[var(--two)] text-[18px] mb-10 font-bold",children:"PATIENTS DASHBOARD"}),e.jsx(te,{children:e.jsx(ae,{children:Se.map(n=>e.jsx(le,{children:e.jsx(de,{asChild:!0,className:"hover:bg-[var(--three)] hover:text-[var(--six)]",children:e.jsxs("button",{onClick:()=>i(n.title),children:[e.jsx(n.icon,{className:"text-[var(--two)]"}),e.jsx("span",{className:"text-[var(--two)]  ",children:n.title})]})})},n.title))})})]})}),e.jsx(ce,{})]}),e.jsxs("main",{className:"flex-1 p-4",children:[e.jsx(oe,{}),r==="Home"?e.jsx(_,{}):r==="Inbox"?e.jsx(_e,{}):r==="Settings"?e.jsx(xe,{}):e.jsx(_,{})]})]})},Ie=()=>e.jsx("div",{children:e.jsx(ke,{})});export{Ie as default};
